# restart
create database sh_self_load_test4;
use sh_self_load_test4;
create table tt (score int , name char(10), id int primary key, gender char(1)) secondary_engine=rapid;
insert into tt values(1, 'n1', 1, 'm'), (2, 'n2', 2, 'f'), (3, 'n3', 3, 'm');
select name, score, id, gender from tt where score >=1  and score < 3 order by id;
name	score	id	gender
n1	1	1	m
n2	2	2	f
select * from tt where score >=1  and id < 3 order by id;
score	name	id	gender
1	n1	1	m
2	n2	2	f
select * from tt where id >=1  and id < 3 order by id;
score	name	id	gender
1	n1	1	m
2	n2	2	f
create table tt1 (score int, name char(10), id int, gender char(1), primary key(id, score)) secondary_engine=rapid;
insert into tt1 values(10, 'n1', 1, 'm'), (20, 'n2', 2, 'f'), (30, 'n3', 3, 'm');
select * from tt1 where score >=1  and id < 3 order by id;
score	name	id	gender
10	n1	1	m
20	n2	2	f
select * from tt1 where score >=1  and score < 3 order by id;
score	name	id	gender
select * from tt1 where id >=1  and id < 3 order by id;
score	name	id	gender
10	n1	1	m
20	n2	2	f
select score from tt1 where id > 2  and score = 30 order by id;
score
30
create table tt2 (score int, name char(10), id int primary key, gender char(1));
insert into tt2 values(1, 'n1', 1, 'm'), (2, 'n2', 2, 'f'), (3, 'n3', 3, 'm');
alter table tt2 secondary_engine=rapid;
select * from tt2 order by id;
score	name	id	gender
1	n1	1	m
2	n2	2	f
3	n3	3	m
create table tt3 (score int primary key, name char(10), id int, gender char(1), key(id, score));
insert into tt3 values(1, 'n1', 1, 'm'), (2, 'n2', 2, 'f'), (3, 'n3', 3, 'm');
alter table tt3 secondary_engine=rapid;
select * from tt3 where score >1 order by id;
score	name	id	gender
2	n2	2	f
3	n3	3	m
create table tt4 (score double primary key, name char(10), id int, gender char(1));
insert into tt4 values(1.1, 'n1', 1, 'm'), (2.2, 'n2', 2, 'f'), (3.3, 'n3', 3, 'm');
alter table tt4 secondary_engine=rapid;
create table tt5 (score double primary key, name char(10), id int, gender char(1));
insert into tt5 values(1.1, 'n1', 1, 'm'), (2.2, 'n2', 2, 'f'), (3.3, 'n3', 3, 'm');
alter table tt5 secondary_engine=rapid;
create table tt6 (score double primary key, name char(10), id int, gender char(1));
insert into tt6 values(1.1, 'n1', 1, 'm'), (2.2, 'n2', 2, 'f'), (3.3, 'n3', 3, 'm');
alter table tt6 secondary_engine=rapid;
create table tt7 (score double primary key, name char(10), id int, gender char(1));
insert into tt7 values(1.1, 'n1', 1, 'm'), (2.2, 'n2', 2, 'f'), (3.3, 'n3', 3, 'm');
alter table tt7 secondary_engine=rapid;
create table tt8 (score double primary key, name char(10), id int, gender char(1));
insert into tt8 values(1.1, 'n1', 1, 'm'), (2.2, 'n2', 2, 'f'), (3.3, 'n3', 3, 'm');
alter table tt8 secondary_engine=rapid;
create table tt9 (score double primary key, name char(10), id int, gender char(1));
insert into tt9 values(1.1, 'n1', 1, 'm'), (2.2, 'n2', 2, 'f'), (3.3, 'n3', 3, 'm');
alter table tt9 secondary_engine=rapid;
select * from performance_schema.rpd_mirror order by TABLE_NAME;
SCHEMA_NAME	TABLE_NAME	MYSQL_ACCESS_COUNT	HEATWAVE_ACCESS_COUNT	IMPORTANCE	LAST_QUERIED	LAST_QUERIED_IN_HEATWAVE	STATE	RECOMMENDED_READ_THREADS	QUERIED_PARTITIONS
sh_self_load_test4	tt	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt1	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt2	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt3	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt4	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt5	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt6	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt7	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt8	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt9	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
alter table tt secondary_load;
alter table tt1 secondary_load;
alter table tt2 secondary_load;
select * from performance_schema.rpd_mirror order by TABLE_NAME;
SCHEMA_NAME	TABLE_NAME	MYSQL_ACCESS_COUNT	HEATWAVE_ACCESS_COUNT	IMPORTANCE	LAST_QUERIED	LAST_QUERIED_IN_HEATWAVE	STATE	RECOMMENDED_READ_THREADS	QUERIED_PARTITIONS
sh_self_load_test4	tt	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt1	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt2	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt3	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt4	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt5	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt6	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt7	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt8	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
sh_self_load_test4	tt9	0	0	1	IGNORE	IGNORE	NOT_LOADED	4	[]
show variables like "%rapid_self%";
Variable_name	Value
rapid_self_load_base_relation_fill_percentage	70
rapid_self_load_enabled	OFF
rapid_self_load_interval_seconds	86400
rapid_self_load_skip_quiet_check	OFF
set global rapid_self_load_interval_seconds= 60;
set global rapid_self_load_base_relation_fill_percentage=90;
set global rapid_self_load_skip_quiet_check=on;
set global rapid_self_load_enabled=on;
show variables like "%rapid_self%";
Variable_name	Value
rapid_self_load_base_relation_fill_percentage	90
rapid_self_load_enabled	ON
rapid_self_load_interval_seconds	60
rapid_self_load_skip_quiet_check	ON
select * from performance_schema.rpd_mirror order by TABLE_NAME;
SCHEMA_NAME	TABLE_NAME	MYSQL_ACCESS_COUNT	HEATWAVE_ACCESS_COUNT	IMPORTANCE	LAST_QUERIED	LAST_QUERIED_IN_HEATWAVE	STATE	RECOMMENDED_READ_THREADS	QUERIED_PARTITIONS
sh_self_load_test4	tt	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt1	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt2	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt3	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt4	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt5	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt6	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt7	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt8	0	0	1	IGNORE	IGNORE	LOADED	4	[]
sh_self_load_test4	tt9	0	0	1	IGNORE	IGNORE	LOADED	4	[]
select * from performance_schema.rpd_tables;
ID	SNAPSHOT_SCN	PERSISTED_SCN	POOL_TYPE	DATA_PLACEMENT_TYPE	NROWS	LOAD_STATUS	LOAD_PROGRESS	SIZE_BYTES	TRANSFORMATION_BYTES	QUERY_COUNT	LAST_QUERIED	LOAD_START_TIMESTAMP	LOAD_END_TIMESTAMP	RECOVERY_SOURCE	RECOVERY_START_TIMESTAMP	RECOVERY_END_TIMESTAMP	LOAD_TYPE	LOGICAL_PARTS_LOADED_AT_SCN	AUTO_ZMP_COLUMNS	ACE_MODEL
IGNORE	IGNORE	0	SNAPSHOT	0	0	NOLOAD_RPDGSTABSTATE	0	0	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	USER	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	100	168	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	USER	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	100	168	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	USER	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	100	168	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	USER	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	56	0	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	SELF	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	56	0	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	SELF	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	56	0	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	SELF	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	56	0	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	SELF	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	56	0	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	SELF	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	56	0	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	SELF	IGNORE	[]	0
IGNORE	IGNORE	0	SNAPSHOT	0	3	AVAIL_RPDGSTABSTATE	56	0	0	0	0000-00-00 00:00:00	IGNORE	IGNORE	OBJECTSTORAGE	0000-00-00 00:00:00	0000-00-00 00:00:00	SELF	IGNORE	[]	0
set global rapid_self_load_enabled=off;
drop database sh_self_load_test4;
