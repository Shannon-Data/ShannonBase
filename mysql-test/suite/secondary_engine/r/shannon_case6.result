create database sh_test6;
use sh_test6;
set use_secondary_engine=forced;
create table tt6 (score int, name char(10), id int not secondary, gender char(1)) secondary_engine=rapid;
insert into tt6 values(10, 'n1', 1, 'm'), (20, 'n2', 2, 'f'), (30, 'n3', 3, 'm');
insert into tt6 values(1, 'n1', 1, 'm'), (2, 'n2', 2, 'f'), (3, 'n3', 3, 'm'), (4,'n4',4,'f');
alter table tt6 secondary_load;
explain select * from tt6 order by id;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	tt6	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	Using filesort
select * from tt6 order by id;
score	name	id	gender
10	n1	1	m
1	n1	1	m
20	n2	2	f
2	n2	2	f
30	n3	3	m
3	n3	3	m
4	n4	4	f
explain select score, name, gender from tt6 order by score;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	tt6	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	Using filesort; Using secondary engine Rapid
select score, name, gender from tt6 order by score;
score	name	gender
1	n1	m
2	n2	f
3	n3	m
4	n4	f
10	n1	m
20	n2	f
30	n3	m
explain select score, id from tt6;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	tt6	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	NULL
select score, id from tt6;
score	id
10	1
20	2
30	3
1	1
2	2
3	3
4	4
explain select score, name, gender from tt6 order by id;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	tt6	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	Using filesort
select score, name, gender from tt6 order by id;
score	name	gender
10	n1	m
1	n1	m
20	n2	f
2	n2	f
30	n3	m
3	n3	m
4	n4	f
explain select id from tt6;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	tt6	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	NULL
select id from tt6;
id
1
2
3
1
2
3
4
explain select sum(score), name, gender from tt6 group by name, gender;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	tt6	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	Using temporary; Using secondary engine Rapid
select sum(score), name, gender from tt6 group by name, gender;
sum(score)	name	gender
11	n1	m
22	n2	f
33	n3	m
4	n4	f
explain select avg(score), gender from tt6 group by gender;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	tt6	NULL	ALL	NULL	NULL	NULL	NULL	3	100.00	Using temporary; Using secondary engine Rapid
select avg(score), gender from tt6 group by gender;
avg(score)	gender
11.0000	m
8.6667	f
alter table tt6 secondary_unload;
drop database sh_test6;
