create database test_partition;
alter database test_partition CHARACTER SET ascii COLLATE ascii_bin;
use test_partition;
CREATE TABLE LINEITEM ( L_ORDERKEY    BIGINT NOT NULL,
L_PARTKEY     INTEGER NOT NULL,
L_SUPPKEY     INTEGER NOT NULL,
L_LINENUMBER  INTEGER NOT NULL,
L_QUANTITY    DECIMAL(15,2) NOT NULL,
L_EXTENDEDPRICE  DECIMAL(15,2) NOT NULL,
L_DISCOUNT    DECIMAL(15,2) NOT NULL,
L_TAX         DECIMAL(15,2) NOT NULL,
L_RETURNFLAG  CHAR(1) NOT NULL,
L_LINESTATUS  CHAR(1) NOT NULL,
L_SHIPDATE    DATE NOT NULL,
L_COMMITDATE  DATE NOT NULL,
L_RECEIPTDATE DATE NOT NULL,
L_SHIPINSTRUCT CHAR(25) NOT NULL,
L_SHIPMODE     CHAR(10) NOT NULL,
L_COMMENT      VARCHAR(44) NOT NULL,
PRIMARY KEY (L_ORDERKEY, L_LINENUMBER))
PARTITION BY KEY()
PARTITIONS 128;
alter table LINEITEM secondary_engine NULL;
alter table LINEITEM change L_RETURNFLAG L_RETURNFLAG CHAR(1) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_LINESTATUS L_LINESTATUS CHAR(1) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_SHIPINSTRUCT L_SHIPINSTRUCT CHAR(25) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_COMMENT L_COMMENT VARCHAR(44) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_SHIPMODE L_SHIPMODE CHAR(10) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_ORDERKEY L_ORDERKEY BIGINT NOT NULL COMMENT 'RAPID_COLUMN=DATA_PLACEMENT_KEY=1';
set use_secondary_engine=forced;
alter table LINEITEM secondary_engine RAPID;
alter table LINEITEM secondary_load;
ERROR HY000: Rapid allocated memory exceeds over the maximum
alter table LINEITEM secondary_unload;
ERROR HY000: DDLs on a table with a secondary engine defined are not allowed.
alter table LINEITEM secondary_load PARTITION(p0, p1, p10);
alter table LINEITEM secondary_unload;
alter table LINEITEM secondary_load PARTITION(p0, p1, p10);
alter table LINEITEM secondary_unload PARTITION(p0, p10, p1);
alter table LINEITEM secondary_load PARTITION(p0, p1, p10);
alter table LINEITEM secondary_unload PARTITION(p0, p10);
alter table LINEITEM secondary_unload;
drop table LINEITEM;
CREATE TABLE LINEITEM ( L_ORDERKEY    BIGINT NOT NULL,
L_PARTKEY     INTEGER NOT NULL,
L_SUPPKEY     INTEGER NOT NULL,
L_LINENUMBER  INTEGER NOT NULL,
L_QUANTITY    DECIMAL(15,2) NOT NULL,
L_EXTENDEDPRICE  DECIMAL(15,2) NOT NULL,
L_DISCOUNT    DECIMAL(15,2) NOT NULL,
L_TAX         DECIMAL(15,2) NOT NULL,
L_RETURNFLAG  CHAR(1) NOT NULL,
L_LINESTATUS  CHAR(1) NOT NULL,
L_SHIPDATE    DATE NOT NULL,
L_COMMITDATE  DATE NOT NULL,
L_RECEIPTDATE DATE NOT NULL,
L_SHIPINSTRUCT CHAR(25) NOT NULL,
L_SHIPMODE     CHAR(10) NOT NULL,
L_COMMENT      VARCHAR(44) NOT NULL,
PRIMARY KEY (L_ORDERKEY, L_LINENUMBER))
PARTITION BY KEY()
PARTITIONS 18;
alter table LINEITEM secondary_engine NULL;
alter table LINEITEM change L_RETURNFLAG L_RETURNFLAG CHAR(1) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_LINESTATUS L_LINESTATUS CHAR(1) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_SHIPINSTRUCT L_SHIPINSTRUCT CHAR(25) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_COMMENT L_COMMENT VARCHAR(44) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_SHIPMODE L_SHIPMODE CHAR(10) NOT NULL COMMENT 'RAPID_COLUMN=ENCODING=SORTED';
alter table LINEITEM change L_ORDERKEY L_ORDERKEY BIGINT NOT NULL COMMENT 'RAPID_COLUMN=DATA_PLACEMENT_KEY=1';
alter table LINEITEM secondary_engine RAPID;
alter table LINEITEM secondary_load;
explain select * from LINEITEM;
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	LINEITEM	p0,p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17	ALL	NULL	NULL	NULL	NULL	0	0.00	Using secondary engine Rapid
Warnings:
Note	1003	/* select#1 */ select `test_partition`.`LINEITEM`.`L_ORDERKEY` AS `L_ORDERKEY`,`test_partition`.`LINEITEM`.`L_PARTKEY` AS `L_PARTKEY`,`test_partition`.`LINEITEM`.`L_SUPPKEY` AS `L_SUPPKEY`,`test_partition`.`LINEITEM`.`L_LINENUMBER` AS `L_LINENUMBER`,`test_partition`.`LINEITEM`.`L_QUANTITY` AS `L_QUANTITY`,`test_partition`.`LINEITEM`.`L_EXTENDEDPRICE` AS `L_EXTENDEDPRICE`,`test_partition`.`LINEITEM`.`L_DISCOUNT` AS `L_DISCOUNT`,`test_partition`.`LINEITEM`.`L_TAX` AS `L_TAX`,`test_partition`.`LINEITEM`.`L_RETURNFLAG` AS `L_RETURNFLAG`,`test_partition`.`LINEITEM`.`L_LINESTATUS` AS `L_LINESTATUS`,`test_partition`.`LINEITEM`.`L_SHIPDATE` AS `L_SHIPDATE`,`test_partition`.`LINEITEM`.`L_COMMITDATE` AS `L_COMMITDATE`,`test_partition`.`LINEITEM`.`L_RECEIPTDATE` AS `L_RECEIPTDATE`,`test_partition`.`LINEITEM`.`L_SHIPINSTRUCT` AS `L_SHIPINSTRUCT`,`test_partition`.`LINEITEM`.`L_SHIPMODE` AS `L_SHIPMODE`,`test_partition`.`LINEITEM`.`L_COMMENT` AS `L_COMMENT` from `test_partition`.`LINEITEM`
select * from LINEITEM;
L_ORDERKEY	L_PARTKEY	L_SUPPKEY	L_LINENUMBER	L_QUANTITY	L_EXTENDEDPRICE	L_DISCOUNT	L_TAX	L_RETURNFLAG	L_LINESTATUS	L_SHIPDATE	L_COMMITDATE	L_RECEIPTDATE	L_SHIPINSTRUCT	L_SHIPMODE	L_COMMENT
alter table LINEITEM secondary_unload;
SET SESSION optimizer_switch='hypergraph_optimizer=on';
Warnings:
Warning	1287	The hypergraph optimizer is highly experimental and is meant for testing only. Do not enable it unless you are a MySQL developer.
set use_secondary_engine=1;
set secondary_engine_cost_threshold =1.5;
set rapid_use_dynamic_offload=1;
SET optimizer_trace = 'enabled=on';
SET SESSION optimizer_switch='hypergraph_optimizer=on';
drop database test_partition;
