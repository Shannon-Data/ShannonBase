create database sh_embedding;
use sh_embedding;
SELECT DISTANCE(STRING_TO_VECTOR("[1.01231, 2.0123123, 3.0123123, 4.01231231]"), STRING_TO_VECTOR("[1, 2, 3, 4]"), "COSINE");
DISTANCE(STRING_TO_VECTOR("[1.01231, 2.0123123, 3.0123123, 4.01231231]"), STRING_TO_VECTOR("[1, 2, 3, 4]"), "COSINE")
0.0000016399679474421447
SELECT DISTANCE(STRING_TO_VECTOR("[1.01231, 2.0123123, 3.0123123, 4.01231231]"), STRING_TO_VECTOR("[1, 2, 3, 4]"), "DOT");
DISTANCE(STRING_TO_VECTOR("[1.01231, 2.0123123, 3.0123123, 4.01231231]"), STRING_TO_VECTOR("[1, 2, 3, 4]"), "DOT")
-30.123122215270996
SELECT DISTANCE(STRING_TO_VECTOR("[1.01231, 2.0123123, 3.0123123, 4.01231231]"), STRING_TO_VECTOR("[1, 2, 3, 4]"), "EUCLIDEAN");
DISTANCE(STRING_TO_VECTOR("[1.01231, 2.0123123, 3.0123123, 4.01231231]"), STRING_TO_VECTOR("[1, 2, 3, 4]"), "EUCLIDEAN")
0.02462363251759866
SELECT ML_MODEL_LIST();
ML_MODEL_LIST()
[{"name": "Llama-3.2-3B-Instruct", "status": "ready"}, {"name": "all-MiniLM-L12-v2", "status": "ready"}, {"name": "multilingual-e5-small", "status": "ready"}]
SELECT sys.ml_embed_row("What is artificial intelligence?", JSON_OBJECT("model_id", "all_minilm_l12_v2"));
ERROR HY000: ML operation failed. can not find the model:all_minilm_l12_v2.
SELECT sys.ml_embed_row("What is artificial intelligence?", JSON_OBJECT("model_id", "all-MiniLM-L12-v2"));
sys.ml_embed_row("What is artificial intelligence?", JSON_OBJECT("model_id", "all-MiniLM-L12-v2"))
IGNORE
SELECT VECTOR_TO_STRING(sys.ml_embed_row("What is artificial intelligence?", JSON_OBJECT("model_id", "all-MiniLM-L12-v2")));
VECTOR_TO_STRING(sys.ml_embed_row("What is artificial intelligence?", JSON_OBJECT("model_id", "all-MiniLM-L12-v2")))
IGNORE
CREATE TABLE tt (score int, name char(10), id int primary key, gender char(1));
INSERT INTO tt values(1, 'n1', 1, 'm'), (2, 'n2', 2, 'f'), (3, 'n3', 3, 'm');
CALL sys.ML_EMBED_TABLE("sh_embedding.tt.name", "sh_embedding.tt.embed_vect", JSON_OBJECT("model_id", "all-MiniLM-L12-v2"));
CALL sys.ML_EMBED_TABLE("sh_embedding.tt.name", "test.tt.embed_vect", JSON_OBJECT("model_id", "aall-MiniLM-L12-v2"));
ERROR 42S21: Duplicate column name 'id'
CALL sys.ML_EMBED_TABLE("test.tt.name", "test.tt.embed_vect", JSON_OBJECT("model_id", "aall-MiniLM-L12-v2"));
ERROR 45000: Input table does not exist
CALL sys.ML_EMBED_TABLE("test.tt.name", "test.tt.embed_vect", JSON_OBJECT("odel_id", "all-MiniLM-L12-v2"));
ERROR 45000: model_id is required in options
CALL sys.ML_EMBED_TABLE("test.tt.name", "test.tt.embed_vect1", JSON_OBJECT("model_id", "aall-MiniLM-L12-v2"));
ERROR 45000: Input table does not exist
SELECT * FROM tt;
score	name	id	gender	embed_vect	details
1	n1	1	m	IGNORE	NULL
2	n2	2	f	IGNORE	NULL
3	n3	3	m	IGNORE	NULL
SHOW CREATE TABLE tt;
Table	Create Table
tt	CREATE TABLE `tt` (
  `score` int DEFAULT NULL,
  `name` char(10) DEFAULT NULL,
  `id` int NOT NULL,
  `gender` char(1) DEFAULT NULL,
  `embed_vect` vector(2048) DEFAULT NULL,
  `details` text,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
DROP DATABASE sh_embedding;
